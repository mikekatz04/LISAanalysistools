

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Introduction &mdash; lisaanalysistools 1.0.16 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=588f6264"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="GW Source Tools" href="../user/sources.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            lisaanalysistools
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/sensitivity.html">Sensitivity Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/detector.html">Detector Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/stochastic.html">Stochastic Signals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/datacontainer.html">Data / Residual / Signal Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/datacontainer.html#analysis-container">Analysis Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/diagnostic.html">Diagnostics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/sources.html">GW Source Tools</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="#LISA-Sensitivity">LISA Sensitivity</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#PSD-for-TDI-channels-X,Y,Z">PSD for TDI channels X,Y,Z</a></li>
<li class="toctree-l2"><a class="reference internal" href="#PSD-for-TDI-channels-A,E,T">PSD for TDI channels A,E,T</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Sensitivity-Matrices">Sensitivity Matrices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Orbits">Orbits</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Link-light-travel-times.">Link light travel times.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Spacecraft-positions">Spacecraft positions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Defining-a-LISAModel">Defining a <code class="docutils literal notranslate"><span class="pre">LISAModel</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="#Diagnostics">Diagnostics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Inner-Product">Inner Product</a></li>
<li class="toctree-l2"><a class="reference internal" href="#SNR">SNR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Perturbed-Waveform">Perturbed Waveform</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Derivative-of-Waveform">Derivative of Waveform</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Information-Matrix-and-Covariance">Information Matrix and Covariance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Plot-Covariance-in-Corner-Plot">Plot Covariance in Corner Plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Get-Eigeninfo-of-a-matrix-(high-precision-capability)">Get Eigeninfo of a matrix (high-precision capability)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Scale-to-a-given-SNR">Scale to a given SNR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Bias-estimate">Bias estimate</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Data-/-Residual-/-Signal-Container">Data / Residual / Signal Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="#Analysis-Container">Analysis Container</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Direct-computations-on-the-residual-contained-in-the-DataResidualArrray.">Direct computations on the residual contained in the <code class="docutils literal notranslate"><span class="pre">DataResidualArrray</span></code>.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Build-a-template-and-then-compare-it-to-the-data.">Build a template and then compare it to the data.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Build-a-template-generation-model-and-add-to-the-AnalysisContainer">Build a template generation model and add to the <code class="docutils literal notranslate"><span class="pre">AnalysisContainer</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Comparing-XYZ-and-AET">Comparing XYZ and AET</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">lisaanalysistools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Introduction</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorial/lisatools_tutorial.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Introduction">
<h1>Introduction<a class="headerlink" href="#Introduction" title="Link to this heading">ÔÉÅ</a></h1>
<p>LISA Analysis Tools is a group of code packages that brings together many different aspects of LISA data analysis. In this tutorial, we will describe the functionality of the main high-level package: <code class="docutils literal notranslate"><span class="pre">lisatools</span></code>. This includes defining sensitivity, orbit, and other information. Also, this includes computing many basic waveform-level diagnostics.</p>
<p>The documentation for <code class="docutils literal notranslate"><span class="pre">lisatools</span></code> can be found <a class="reference external" href="https://mikekatz04.github.io/LISAanalysistools">here</a>.</p>
<p>If you use this code, please cite the <a class="reference external" href="https://zenodo.org/records/10930980">zenodo</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">eryn.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">TransformContainer</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">lisatools.sensitivity</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lisatools.utils.constants</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lisatools.diagnostic</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lisatools.detector</span><span class="w"> </span><span class="kn">import</span> <span class="n">EqualArmlengthOrbits</span><span class="p">,</span> <span class="n">ESAOrbits</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lisatools.detector</span><span class="w"> </span><span class="kn">import</span> <span class="n">LISAModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lisatools.detector</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_available_default_lisa_models</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lisatools.detector</span><span class="w"> </span><span class="kn">import</span> <span class="n">scirdv1</span>
<br/></pre></div>
</div>
</div>
</section>
<section id="LISA-Sensitivity">
<h1>LISA Sensitivity<a class="headerlink" href="#LISA-Sensitivity" title="Link to this heading">ÔÉÅ</a></h1>
<p>We will begin with generating the LISA sensitivity. You can do this with the <code class="docutils literal notranslate"><span class="pre">lisatools.sensitivity.get_sensitivity</span></code> function. Some helpful keyword arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sens_fn</span></code>: Type of sensitivity response function. Base sensitivity or TDI sensitivity. Base sensitivity: <code class="docutils literal notranslate"><span class="pre">LISASens</span></code>. TDI sensitivities are shown below.</p></li>
<li><p>return_type: PSD, ASD, or characteristic strain.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">Sn</span> <span class="o">=</span> <span class="n">get_sensitivity</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sens_fn</span><span class="o">=</span><span class="n">LISASens</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;char_strain&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Sn</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency (Hz)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Characteristic Strain&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Characteristic Strain&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_lisatools_tutorial_5_1.png" src="../_images/tutorial_lisatools_tutorial_5_1.png" />
</div>
</div>
<p>Stock sensitivity options can be found with <code class="docutils literal notranslate"><span class="pre">lisatools.sensitivity.get_stock_sensitivity_options</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">lisatools.sensitivity</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_stock_sensitivity_options</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_stock_sensitivity_options</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;X1TDISens&#39;,
 &#39;Y1TDISens&#39;,
 &#39;Z1TDISens&#39;,
 &#39;XY1TDISens&#39;,
 &#39;YZ1TDISens&#39;,
 &#39;ZX1TDISens&#39;,
 &#39;A1TDISens&#39;,
 &#39;E1TDISens&#39;,
 &#39;T1TDISens&#39;,
 &#39;X2TDISens&#39;,
 &#39;Y2TDISens&#39;,
 &#39;Z2TDISens&#39;,
 &#39;LISASens&#39;,
 &#39;CornishLISASens&#39;,
 &#39;FlatPSDFunction&#39;]
</pre></div></div>
</div>
<section id="PSD-for-TDI-channels-X,Y,Z">
<h2>PSD for TDI channels X,Y,Z<a class="headerlink" href="#PSD-for-TDI-channels-X,Y,Z" title="Link to this heading">ÔÉÅ</a></h2>
<p>Plot the TDI X,Y,Z channels (<code class="docutils literal notranslate"><span class="pre">X1TDISens</span></code>, <code class="docutils literal notranslate"><span class="pre">Y1TDISens</span></code>, <code class="docutils literal notranslate"><span class="pre">Z1TDISens</span></code>) and cross-sensitivity (<code class="docutils literal notranslate"><span class="pre">XY1TDISens</span></code>, <code class="docutils literal notranslate"><span class="pre">YZ1TDISens</span></code>, <code class="docutils literal notranslate"><span class="pre">ZX1TDISens</span></code>). The ‚Äú1‚Äù here represents TDI generation 1. TDI 2 is available, but not the cross-terms yet. They need to be added.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">Sn</span> <span class="o">=</span> <span class="n">get_sensitivity</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sens_fn</span><span class="o">=</span><span class="n">X1TDISens</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;PSD&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Sn</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;X,Y,Z&quot;</span><span class="p">)</span>
<span class="n">Cn</span> <span class="o">=</span> <span class="n">get_sensitivity</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sens_fn</span><span class="o">=</span><span class="n">XY1TDISens</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;PSD&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Cn</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;XY, YZ, ZX&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency (Hz)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;PSD&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;PSD&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_lisatools_tutorial_11_1.png" src="../_images/tutorial_lisatools_tutorial_11_1.png" />
</div>
</div>
</section>
<section id="PSD-for-TDI-channels-A,E,T">
<h2>PSD for TDI channels A,E,T<a class="headerlink" href="#PSD-for-TDI-channels-A,E,T" title="Link to this heading">ÔÉÅ</a></h2>
<p>Similary now for TDI A,E,T channels.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">SnA</span> <span class="o">=</span> <span class="n">get_sensitivity</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sens_fn</span><span class="o">=</span><span class="n">A1TDISens</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;PSD&quot;</span><span class="p">)</span>
<span class="n">SnE</span> <span class="o">=</span> <span class="n">get_sensitivity</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sens_fn</span><span class="o">=</span><span class="n">E1TDISens</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;PSD&quot;</span><span class="p">)</span>
<span class="n">SnT</span> <span class="o">=</span> <span class="n">get_sensitivity</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sens_fn</span><span class="o">=</span><span class="n">T1TDISens</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;PSD&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">SnA</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">SnE</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;E&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">SnT</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency (Hz)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;PSD&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;PSD&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_lisatools_tutorial_14_1.png" src="../_images/tutorial_lisatools_tutorial_14_1.png" />
</div>
</div>
</section>
<section id="Sensitivity-Matrices">
<h2>Sensitivity Matrices<a class="headerlink" href="#Sensitivity-Matrices" title="Link to this heading">ÔÉÅ</a></h2>
<p>Sensitivity Matrices create a holder for sensitivity information across different channels. It allows for a common backend to be fed to diagnostic functions regardless if you are using AET in a length 3 array, XYZ in 3x3 matrix, or a set of basic <code class="docutils literal notranslate"><span class="pre">LISASens</span></code> objects. Sensitivity matrices can plot your sensitivity and update information on the fly (like if the frequency changes).</p>
<p>Here is a custom version of a 3x3 sensitivity matrix.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sens_mat</span> <span class="o">=</span> <span class="n">SensitivityMatrix</span><span class="p">(</span>
    <span class="n">f</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="n">X1TDISens</span><span class="p">,</span> <span class="n">XY1TDISens</span><span class="p">,</span> <span class="n">ZX1TDISens</span><span class="p">],</span>
        <span class="p">[</span><span class="n">XY1TDISens</span><span class="p">,</span> <span class="n">Y1TDISens</span><span class="p">,</span> <span class="n">YZ1TDISens</span><span class="p">],</span>
        <span class="p">[</span><span class="n">ZX1TDISens</span><span class="p">,</span> <span class="n">YZ1TDISens</span><span class="p">,</span> <span class="n">Z1TDISens</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="n">stochastic_params</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">YRSID_SI</span><span class="p">,),</span>
    <span class="n">model</span><span class="o">=</span><span class="n">lisa_models</span><span class="o">.</span><span class="n">scirdv1</span><span class="p">,</span>
<span class="p">)</span>
<br/></pre></div>
</div>
</div>
<p>You can see the stock SensitivityMatrix options with <code class="docutils literal notranslate"><span class="pre">lisatools.sensitivity.get_stock_sensitivity_matrix_options</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">lisatools.sensitivity</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_stock_sensitivity_matrix_options</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_stock_sensitivity_matrix_options</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;XYZ1SensitivityMatrix&#39;, &#39;AET1SensitivityMatrix&#39;, &#39;AE1SensitivityMatrix&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sens_mat2</span> <span class="o">=</span> <span class="n">AE1SensitivityMatrix</span><span class="p">(</span>
    <span class="n">f</span><span class="p">,</span>
    <span class="c1"># stochastic_params=None, (1.0 * YRSID_SI,),</span>
    <span class="n">model</span><span class="o">=</span><span class="n">lisa_models</span><span class="o">.</span><span class="n">scirdv1</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">sens_mat2</span><span class="o">.</span><span class="n">loglog</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&lt;Figure size 640x480 with 2 Axes&gt;, array([&lt;Axes: &gt;, &lt;Axes: &gt;], dtype=object))
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_lisatools_tutorial_21_1.png" src="../_images/tutorial_lisatools_tutorial_21_1.png" />
</div>
</div>
<p>You can adjust the frequencies, model, or stochastic information (see below for Stochastic) with the methods that start with ‚Äúupdate.‚Äù For the frequency:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sens_mat2</span><span class="o">.</span><span class="n">update_frequency_arr</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sens_mat2</span><span class="o">.</span><span class="n">frequency_arr</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0.0001    , 0.00010069, 0.00010139, 0.0001021 , 0.0001028 ,
       0.00010352, 0.00010424, 0.00010496, 0.00010569, 0.00010642,
       0.00010716, 0.0001079 , 0.00010865, 0.00010941, 0.00011016,
       0.00011093, 0.0001117 , 0.00011247, 0.00011325, 0.00011404,
       0.00011483, 0.00011563, 0.00011643, 0.00011724, 0.00011805,
       0.00011887, 0.0001197 , 0.00012053, 0.00012136, 0.0001222 ,
       0.00012305, 0.00012391, 0.00012477, 0.00012563, 0.0001265 ,
       0.00012738, 0.00012826, 0.00012915, 0.00013005, 0.00013095,
       0.00013186, 0.00013278, 0.0001337 , 0.00013463, 0.00013556,
       0.0001365 , 0.00013745, 0.0001384 , 0.00013936, 0.00014033,
       0.0001413 , 0.00014228, 0.00014327, 0.00014426, 0.00014527,
       0.00014627, 0.00014729, 0.00014831, 0.00014934, 0.00015038,
       0.00015142, 0.00015247, 0.00015353, 0.00015459, 0.00015567,
       0.00015675, 0.00015783, 0.00015893, 0.00016003, 0.00016114,
       0.00016226, 0.00016339, 0.00016452, 0.00016566, 0.00016681,
       0.00016797, 0.00016913, 0.00017031, 0.00017149, 0.00017268,
       0.00017388, 0.00017508, 0.0001763 , 0.00017752, 0.00017875,
       0.00017999, 0.00018124, 0.0001825 , 0.00018377, 0.00018504,
       0.00018632, 0.00018762, 0.00018892, 0.00019023, 0.00019155,
       0.00019288, 0.00019422, 0.00019557, 0.00019692, 0.00019829,
       0.00019966, 0.00020105, 0.00020244, 0.00020385, 0.00020526,
       0.00020669, 0.00020812, 0.00020957, 0.00021102, 0.00021248,
       0.00021396, 0.00021544, 0.00021694, 0.00021844, 0.00021996,
       0.00022149, 0.00022302, 0.00022457, 0.00022613, 0.0002277 ,
       0.00022928, 0.00023087, 0.00023247, 0.00023408, 0.00023571,
       0.00023734, 0.00023899, 0.00024065, 0.00024232, 0.000244  ,
       0.00024569, 0.0002474 , 0.00024911, 0.00025084, 0.00025258,
       0.00025433, 0.0002561 , 0.00025788, 0.00025967, 0.00026147,
       0.00026328, 0.00026511, 0.00026695, 0.0002688 , 0.00027067,
       0.00027254, 0.00027443, 0.00027634, 0.00027826, 0.00028019,
       0.00028213, 0.00028409, 0.00028606, 0.00028804, 0.00029004,
       0.00029206, 0.00029408, 0.00029612, 0.00029818, 0.00030025,
       0.00030233, 0.00030443, 0.00030654, 0.00030867, 0.00031081,
       0.00031296, 0.00031514, 0.00031732, 0.00031952, 0.00032174,
       0.00032397, 0.00032622, 0.00032849, 0.00033076, 0.00033306,
       0.00033537, 0.0003377 , 0.00034004, 0.0003424 , 0.00034478,
       0.00034717, 0.00034958, 0.000352  , 0.00035445, 0.0003569 ,
       0.00035938, 0.00036187, 0.00036439, 0.00036691, 0.00036946,
       0.00037202, 0.00037461, 0.0003772 , 0.00037982, 0.00038246,
       0.00038511, 0.00038778, 0.00039047, 0.00039318, 0.00039591,
       0.00039866, 0.00040142, 0.00040421, 0.00040701, 0.00040984,
       0.00041268, 0.00041555, 0.00041843, 0.00042133, 0.00042426,
       0.0004272 , 0.00043016, 0.00043315, 0.00043615, 0.00043918,
       0.00044223, 0.0004453 , 0.00044839, 0.0004515 , 0.00045463,
       0.00045778, 0.00046096, 0.00046416, 0.00046738, 0.00047062,
       0.00047389, 0.00047718, 0.00048049, 0.00048382, 0.00048718,
       0.00049056, 0.00049396, 0.00049739, 0.00050084, 0.00050432,
       0.00050782, 0.00051134, 0.00051489, 0.00051846, 0.00052206,
       0.00052568, 0.00052933, 0.000533  , 0.0005367 , 0.00054042,
       0.00054417, 0.00054795, 0.00055175, 0.00055558, 0.00055943,
       0.00056331, 0.00056722, 0.00057116, 0.00057512, 0.00057911,
       0.00058313, 0.00058718, 0.00059125, 0.00059535, 0.00059948,
       0.00060364, 0.00060783, 0.00061205, 0.0006163 , 0.00062057,
       0.00062488, 0.00062921, 0.00063358, 0.00063798, 0.0006424 ,
       0.00064686, 0.00065135, 0.00065587, 0.00066042, 0.000665  ,
       0.00066962, 0.00067426, 0.00067894, 0.00068365, 0.0006884 ,
       0.00069317, 0.00069798, 0.00070282, 0.0007077 , 0.00071261,
       0.00071756, 0.00072253, 0.00072755, 0.0007326 , 0.00073768,
       0.0007428 , 0.00074795, 0.00075314, 0.00075837, 0.00076363,
       0.00076893, 0.00077426, 0.00077964, 0.00078505, 0.00079049,
       0.00079598, 0.0008015 , 0.00080706, 0.00081266, 0.0008183 ,
       0.00082398, 0.0008297 , 0.00083545, 0.00084125, 0.00084709,
       0.00085296, 0.00085888, 0.00086484, 0.00087084, 0.00087689,
       0.00088297, 0.0008891 , 0.00089527, 0.00090148, 0.00090773,
       0.00091403, 0.00092037, 0.00092676, 0.00093319, 0.00093966,
       0.00094618, 0.00095275, 0.00095936, 0.00096602, 0.00097272,
       0.00097947, 0.00098627, 0.00099311, 0.001     , 0.00100694,
       0.00101393, 0.00102096, 0.00102804, 0.00103518, 0.00104236,
       0.00104959, 0.00105688, 0.00106421, 0.00107159, 0.00107903,
       0.00108652, 0.00109405, 0.00110165, 0.00110929, 0.00111699,
       0.00112474, 0.00113254, 0.0011404 , 0.00114831, 0.00115628,
       0.0011643 , 0.00117238, 0.00118052, 0.00118871, 0.00119696,
       0.00120526, 0.00121362, 0.00122204, 0.00123052, 0.00123906,
       0.00124766, 0.00125632, 0.00126503, 0.00127381, 0.00128265,
       0.00129155, 0.00130051, 0.00130954, 0.00131862, 0.00132777,
       0.00133698, 0.00134626, 0.0013556 , 0.00136501, 0.00137448,
       0.00138402, 0.00139362, 0.00140329, 0.00141303, 0.00142283,
       0.0014327 , 0.00144264, 0.00145265, 0.00146273, 0.00147288,
       0.0014831 , 0.00149339, 0.00150376, 0.00151419, 0.0015247 ,
       0.00153528, 0.00154593, 0.00155665, 0.00156746, 0.00157833,
       0.00158928, 0.00160031, 0.00161141, 0.0016226 , 0.00163385,
       0.00164519, 0.00165661, 0.0016681 , 0.00167967, 0.00169133,
       0.00170307, 0.00171488, 0.00172678, 0.00173876, 0.00175083,
       0.00176298, 0.00177521, 0.00178753, 0.00179993, 0.00181242,
       0.00182499, 0.00183766, 0.00185041, 0.00186325, 0.00187617,
       0.00188919, 0.0019023 , 0.0019155 , 0.00192879, 0.00194217,
       0.00195565, 0.00196922, 0.00198288, 0.00199664, 0.0020105 ,
       0.00202445, 0.00203849, 0.00205264, 0.00206688, 0.00208122,
       0.00209566, 0.0021102 , 0.00212485, 0.00213959, 0.00215443,
       0.00216938, 0.00218444, 0.00219959, 0.00221486, 0.00223022,
       0.0022457 , 0.00226128, 0.00227697, 0.00229277, 0.00230868,
       0.0023247 , 0.00234083, 0.00235707, 0.00237342, 0.00238989,
       0.00240648, 0.00242317, 0.00243999, 0.00245692, 0.00247396,
       0.00249113, 0.00250842, 0.00252582, 0.00254335, 0.00256099,
       0.00257876, 0.00259666, 0.00261467, 0.00263282, 0.00265108,
       0.00266948, 0.002688  , 0.00270665, 0.00272543, 0.00274434,
       0.00276339, 0.00278256, 0.00280187, 0.00282131, 0.00284088,
       0.0028606 , 0.00288044, 0.00290043, 0.00292056, 0.00294082,
       0.00296123, 0.00298177, 0.00300246, 0.00302329, 0.00304427,
       0.0030654 , 0.00308666, 0.00310808, 0.00312965, 0.00315136,
       0.00317323, 0.00319525, 0.00321742, 0.00323974, 0.00326222,
       0.00328486, 0.00330765, 0.0033306 , 0.00335371, 0.00337698,
       0.00340041, 0.00342401, 0.00344776, 0.00347169, 0.00349578,
       0.00352003, 0.00354446, 0.00356905, 0.00359381, 0.00361875,
       0.00364386, 0.00366914, 0.0036946 , 0.00372024, 0.00374605,
       0.00377204, 0.00379822, 0.00382457, 0.00385111, 0.00387783,
       0.00390474, 0.00393183, 0.00395911, 0.00398658, 0.00401424,
       0.0040421 , 0.00407014, 0.00409838, 0.00412682, 0.00415546,
       0.00418429, 0.00421332, 0.00424256, 0.00427199, 0.00430164,
       0.00433148, 0.00436154, 0.0043918 , 0.00442227, 0.00445296,
       0.00448386, 0.00451497, 0.0045463 , 0.00457784, 0.0046096 ,
       0.00464159, 0.0046738 , 0.00470622, 0.00473888, 0.00477176,
       0.00480487, 0.00483821, 0.00487178, 0.00490558, 0.00493962,
       0.0049739 , 0.00500841, 0.00504316, 0.00507815, 0.00511339,
       0.00514887, 0.00518459, 0.00522057, 0.00525679, 0.00529327,
       0.00532999, 0.00536698, 0.00540422, 0.00544171, 0.00547947,
       0.00551749, 0.00555578, 0.00559433, 0.00563314, 0.00567223,
       0.00571159, 0.00575122, 0.00579112, 0.00583131, 0.00587177,
       0.00591251, 0.00595353, 0.00599484, 0.00603644, 0.00607832,
       0.0061205 , 0.00616297, 0.00620573, 0.00624879, 0.00629215,
       0.0063358 , 0.00637977, 0.00642403, 0.00646861, 0.00651349,
       0.00655869, 0.00660419, 0.00665002, 0.00669616, 0.00674262,
       0.00678941, 0.00683652, 0.00688395, 0.00693172, 0.00697981,
       0.00702824, 0.00707701, 0.00712612, 0.00717556, 0.00722535,
       0.00727548, 0.00732597, 0.0073768 , 0.00742798, 0.00747952,
       0.00753142, 0.00758368, 0.0076363 , 0.00768928, 0.00774264,
       0.00779636, 0.00785046, 0.00790493, 0.00795978, 0.00801501,
       0.00807062, 0.00812662, 0.00818301, 0.00823979, 0.00829696,
       0.00835453, 0.0084125 , 0.00847087, 0.00852964, 0.00858883,
       0.00864842, 0.00870843, 0.00876886, 0.0088297 , 0.00889097,
       0.00895266, 0.00901478, 0.00907733, 0.00914031, 0.00920373,
       0.00926759, 0.0093319 , 0.00939665, 0.00946185, 0.0095275 ,
       0.00959361, 0.00966017, 0.0097272 , 0.0097947 , 0.00986266,
       0.00993109, 0.01      , 0.01006939, 0.01013925, 0.01020961,
       0.01028045, 0.01035178, 0.01042361, 0.01049593, 0.01056876,
       0.01064209, 0.01071593, 0.01079029, 0.01086516, 0.01094055,
       0.01101646, 0.0110929 , 0.01116987, 0.01124737, 0.01132541,
       0.011404  , 0.01148312, 0.0115628 , 0.01164303, 0.01172382,
       0.01180517, 0.01188708, 0.01196956, 0.01205261, 0.01213624,
       0.01222045, 0.01230524, 0.01239062, 0.0124766 , 0.01256317,
       0.01265034, 0.01273811, 0.0128265 , 0.0129155 , 0.01300511,
       0.01309535, 0.01318621, 0.01327771, 0.01336984, 0.01346261,
       0.01355602, 0.01365008, 0.01374479, 0.01384016, 0.01393619,
       0.01403289, 0.01413026, 0.0142283 , 0.01432703, 0.01442644,
       0.01452654, 0.01462733, 0.01472883, 0.01483103, 0.01493393,
       0.01503755, 0.01514189, 0.01524696, 0.01535275, 0.01545928,
       0.01556654, 0.01567455, 0.01578331, 0.01589283, 0.0160031 ,
       0.01611414, 0.01622595, 0.01633854, 0.01645191, 0.01656606,
       0.01668101, 0.01679675, 0.0169133 , 0.01703065, 0.01714882,
       0.01726781, 0.01738762, 0.01750827, 0.01762975, 0.01775208,
       0.01787526, 0.01799929, 0.01812418, 0.01824993, 0.01837656,
       0.01850407, 0.01863246, 0.01876175, 0.01889193, 0.01902301,
       0.01915501, 0.01928792, 0.01942175, 0.01955651, 0.0196922 ,
       0.01982884, 0.01996642, 0.02010496, 0.02024447, 0.02038493,
       0.02052638, 0.0206688 , 0.02081222, 0.02095662, 0.02110203,
       0.02124845, 0.02139589, 0.02154435, 0.02169384, 0.02184436,
       0.02199593, 0.02214855, 0.02230223, 0.02245698, 0.0226128 ,
       0.0227697 , 0.02292769, 0.02308678, 0.02324697, 0.02340827,
       0.02357069, 0.02373424, 0.02389893, 0.02406475, 0.02423173,
       0.02439986, 0.02456916, 0.02473964, 0.0249113 , 0.02508415,
       0.0252582 , 0.02543346, 0.02560993, 0.02578763, 0.02596656,
       0.02614673, 0.02632815, 0.02651084, 0.02669478, 0.02688001,
       0.02706652, 0.02725433, 0.02744343, 0.02763385, 0.02782559,
       0.02801867, 0.02821308, 0.02840884, 0.02860596, 0.02880444,
       0.0290043 , 0.02920556, 0.0294082 , 0.02961225, 0.02981772,
       0.03002462, 0.03023295, 0.03044272, 0.03065395, 0.03086665,
       0.03108082, 0.03129648, 0.03151363, 0.0317323 , 0.03195248,
       0.03217418, 0.03239743, 0.03262222, 0.03284857, 0.0330765 ,
       0.033306  , 0.0335371 , 0.0337698 , 0.03400412, 0.03424006,
       0.03447764, 0.03471687, 0.03495776, 0.03520031, 0.03544456,
       0.03569049, 0.03593814, 0.0361875 , 0.03643859, 0.03669142,
       0.03694601, 0.03720237, 0.0374605 , 0.03772042, 0.03798215,
       0.0382457 , 0.03851107, 0.03877828, 0.03904735, 0.03931829,
       0.0395911 , 0.03986581, 0.04014242, 0.04042096, 0.04070142,
       0.04098384, 0.04126821, 0.04155455, 0.04184289, 0.04213322,
       0.04242556, 0.04271994, 0.04301636, 0.04331483, 0.04361538,
       0.04391801, 0.04422274, 0.04452959, 0.04483856, 0.04514968,
       0.04546295, 0.04577841, 0.04609604, 0.04641589, 0.04673795,
       0.04706225, 0.0473888 , 0.04771761, 0.0480487 , 0.0483821 ,
       0.0487178 , 0.04905584, 0.04939622, 0.04973896, 0.05008408,
       0.05043159, 0.05078152, 0.05113388, 0.05148867, 0.05184594,
       0.05220568, 0.05256791, 0.05293266, 0.05329994, 0.05366977,
       0.05404216, 0.05441714, 0.05479472, 0.05517492, 0.05555776,
       0.05594326, 0.05633143, 0.05672229, 0.05711586, 0.05751217,
       0.05791123, 0.05831305, 0.05871766, 0.05912508, 0.05953533,
       0.05994843, 0.06036439, 0.06078323, 0.06120498, 0.06162966,
       0.06205729, 0.06248788, 0.06292146, 0.06335805, 0.06379767,
       0.06424034, 0.06468608, 0.06513491, 0.06558686, 0.06604194,
       0.06650018, 0.0669616 , 0.06742622, 0.06789407, 0.06836516,
       0.06883952, 0.06931717, 0.06979814, 0.07028244, 0.07077011,
       0.07126115, 0.07175561, 0.07225349, 0.07275484, 0.07325965,
       0.07376798, 0.07427982, 0.07479523, 0.0753142 , 0.07583678,
       0.07636298, 0.07689284, 0.07742637, 0.0779636 , 0.07850456,
       0.07904928, 0.07959777, 0.08015007, 0.0807062 , 0.08126619,
       0.08183007, 0.08239786, 0.08296959, 0.08354528, 0.08412497,
       0.08470868, 0.08529644, 0.08588829, 0.08648423, 0.08708431,
       0.08768856, 0.088297  , 0.08890966, 0.08952657, 0.09014776,
       0.09077327, 0.09140311, 0.09203732, 0.09267593, 0.09331898,
       0.09396648, 0.09461848, 0.095275  , 0.09593608, 0.09660175,
       0.09727203, 0.09794697, 0.09862658, 0.09931092, 0.1       ])
</pre></div></div>
</div>
</section>
</section>
<section id="Orbits">
<h1>Orbits<a class="headerlink" href="#Orbits" title="Link to this heading">ÔÉÅ</a></h1>
<p>Orbital information is read in from files and stored in an <code class="docutils literal notranslate"><span class="pre">Orbits</span></code> class. There are two stock options: <code class="docutils literal notranslate"><span class="pre">EqualArmlengthOrbits</span></code> and <code class="docutils literal notranslate"><span class="pre">ESAOrbits</span></code>. The files for the classes are directly from the LISAOrbits code. The <code class="docutils literal notranslate"><span class="pre">lisatools</span></code> <code class="docutils literal notranslate"><span class="pre">Orbits</span></code> class can take any file that is output from the LISAOrbits code.</p>
<p>Each orbit class, after instantiation, must be configured. This transforms the input file values into the setup used for analysis. During configuration, you can pass a time array, timestep, or you can ask the orbit class to setup for linear interpolation by passing <code class="docutils literal notranslate"><span class="pre">linear_interp_setup=True</span></code>. This setup will add enough points to the time array to make linear interpolation accurate enough.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">equal</span> <span class="o">=</span> <span class="n">EqualArmlengthOrbits</span><span class="p">()</span>
<span class="n">equal</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">linear_interp_setup</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">esa</span> <span class="o">=</span> <span class="n">ESAOrbits</span><span class="p">()</span>
<span class="n">esa</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">linear_interp_setup</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<p>You can access various information on the orbits with the methods that begin with <code class="docutils literal notranslate"><span class="pre">get</span></code>. You can get light travel times, spacecraft positions, or link normal vectors. These functions require a linear interpolation setup.</p>
<section id="Link-light-travel-times.">
<h2>Link light travel times.<a class="headerlink" href="#Link-light-travel-times." title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">esa</span><span class="o">.</span><span class="n">t_base</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">equal</span><span class="o">.</span><span class="n">t_base</span><span class="o">.</span><span class="n">max</span><span class="p">()]),</span> <span class="mi">1000</span><span class="p">)</span>
<span class="k">for</span> <span class="n">orbits</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">esa</span><span class="p">,</span> <span class="n">equal</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;esa&quot;</span><span class="p">,</span> <span class="s2">&quot;equal&quot;</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">31</span><span class="p">]:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_vals</span><span class="p">,</span> <span class="n">orbits</span><span class="o">.</span><span class="n">get_light_travel_times</span><span class="p">(</span><span class="n">t_vals</span><span class="p">,</span> <span class="n">link</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">link</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Light Travel Time (s)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0, &#39;Time (s)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_lisatools_tutorial_30_1.png" src="../_images/tutorial_lisatools_tutorial_30_1.png" />
</div>
</div>
</section>
<section id="Spacecraft-positions">
<h2>Spacecraft positions<a class="headerlink" href="#Spacecraft-positions" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">esa</span><span class="o">.</span><span class="n">t_base</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">equal</span><span class="o">.</span><span class="n">t_base</span><span class="o">.</span><span class="n">max</span><span class="p">()]),</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">orbits</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">esa</span><span class="p">,</span> <span class="n">equal</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;esa&quot;</span><span class="p">,</span> <span class="s2">&quot;equal&quot;</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">sc</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">orbits</span><span class="o">.</span><span class="n">get_pos</span><span class="p">(</span><span class="n">t_vals</span><span class="p">,</span> <span class="n">sc</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_vals</span><span class="p">,</span> <span class="n">pos</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">sc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">link</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;spacecraft x (m)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;spacecraft y (m)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;spacecraft z (m)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0, &#39;Time (s)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_lisatools_tutorial_32_1.png" src="../_images/tutorial_lisatools_tutorial_32_1.png" />
</div>
</div>
</section>
</section>
<section id="Defining-a-LISAModel">
<h1>Defining a <code class="docutils literal notranslate"><span class="pre">LISAModel</span></code><a class="headerlink" href="#Defining-a-LISAModel" title="Link to this heading">ÔÉÅ</a></h1>
<p>A <code class="docutils literal notranslate"><span class="pre">LISAModel</span></code> is a combination of sensitivity information and orbits. For the sensitivity, we define a two parameter model based on the OMS noise and acceleration noise.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oms_noise_term</span> <span class="o">=</span> <span class="p">(</span><span class="mf">13.0e-12</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">acceleration_noise_term</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.0e-15</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">new_lisa</span> <span class="o">=</span> <span class="n">LISAModel</span><span class="p">(</span><span class="n">oms_noise_term</span><span class="p">,</span> <span class="n">acceleration_noise_term</span><span class="p">,</span> <span class="n">equal</span><span class="p">,</span> <span class="s2">&quot;new_lisa&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># example stock model</span>
<span class="n">get_available_default_lisa_models</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[LISAModel(Soms_d=2.25e-22, Sa_a=9e-30, orbits=&lt;lisatools.detector.DefaultOrbits object at 0x128f126c0&gt;, name=&#39;scirdv1&#39;),
 LISAModel(Soms_d=9.999999999999999e-23, Sa_a=9e-30, orbits=&lt;lisatools.detector.DefaultOrbits object at 0x12fc18560&gt;, name=&#39;proposal&#39;),
 LISAModel(Soms_d=9.999999999999999e-23, Sa_a=5.76e-30, orbits=&lt;lisatools.detector.DefaultOrbits object at 0x118aa04a0&gt;, name=&#39;mrdv1&#39;),
 LISAModel(Soms_d=6.241e-23, Sa_a=5.76e-30, orbits=&lt;lisatools.detector.DefaultOrbits object at 0x11870f470&gt;, name=&#39;sangria&#39;)]
</pre></div></div>
</div>
<p>Compare two models.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>

<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="p">[</span><span class="n">scirdv1</span><span class="p">,</span> <span class="n">new_lisa</span><span class="p">]:</span>
    <span class="n">Sn</span> <span class="o">=</span> <span class="n">get_sensitivity</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sens_fn</span><span class="o">=</span><span class="s2">&quot;LISASens&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Sn</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x148514620&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_lisatools_tutorial_38_1.png" src="../_images/tutorial_lisatools_tutorial_38_1.png" />
</div>
</div>
</section>
<section id="Diagnostics">
<h1>Diagnostics<a class="headerlink" href="#Diagnostics" title="Link to this heading">ÔÉÅ</a></h1>
<p>LISA Analysis Tools comes with a wide variety of diagnostic computations. These can be used in actual pipelines. However, they are slower, so these should mainly be used to check faster Likelihood methods.</p>
<p>To begin, we will define a basic sine wave as our waveform.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">sine_waveform</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">phi0</span><span class="p">,</span> <span class="n">t_arr</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f0</span> <span class="o">*</span> <span class="n">t_arr</span> <span class="o">+</span> <span class="n">phi0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Inner-Product">
<h2>Inner Product<a class="headerlink" href="#Inner-Product" title="Link to this heading">ÔÉÅ</a></h2>
<p>You can take the inner product between to waveforms. See the inner product documentation for keyword arguments and details.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create some fake signals first</span>

<span class="n">A</span> <span class="o">=</span> <span class="mf">1e-22</span>
<span class="n">f0</span> <span class="o">=</span> <span class="mf">4e-3</span>
<span class="n">phi0</span> <span class="o">=</span> <span class="mf">0.2</span>

<span class="n">dt</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">t_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">YRSID_SI</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_arr</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">h1</span> <span class="o">=</span> <span class="n">sine_waveform</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">t_arr</span><span class="p">)</span>
<span class="n">h2</span> <span class="o">=</span> <span class="n">sine_waveform</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">phi0</span><span class="p">,</span> <span class="n">t_arr</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_arr</span><span class="p">[:</span><span class="mi">250</span><span class="p">],</span> <span class="n">h1</span><span class="p">[:</span><span class="mi">250</span><span class="p">])</span>

<span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h1</span><span class="p">),</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">h1</span><span class="p">)))</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="p">(</span><span class="n">get_sensitivity</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">sens_fn</span><span class="o">=</span><span class="s2">&quot;LISASens&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;sangria&quot;</span><span class="p">,</span> <span class="n">stochastic_params</span><span class="o">=</span><span class="p">(</span><span class="n">YRSID_SI</span><span class="p">,))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">df</span><span class="p">))</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>

<span class="n">val</span> <span class="o">=</span> <span class="n">inner_product</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">psd</span><span class="o">=</span><span class="s2">&quot;LISASens&quot;</span><span class="p">,</span> <span class="n">psd_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;sangria&quot;</span><span class="p">,</span> <span class="n">stochastic_params</span><span class="o">=</span><span class="p">(</span><span class="n">YRSID_SI</span><span class="p">,)))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Inner product &lt;h1|h2&gt;: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">complex_val</span> <span class="o">=</span> <span class="n">inner_product</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">psd</span><span class="o">=</span><span class="s2">&quot;LISASens&quot;</span><span class="p">,</span> <span class="n">psd_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;sangria&quot;</span><span class="p">,</span> <span class="n">stochastic_params</span><span class="o">=</span><span class="p">(</span><span class="n">YRSID_SI</span><span class="p">,)),</span> <span class="nb">complex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Complex inner product &lt;h1|h2&gt;: </span><span class="si">{</span><span class="n">complex_val</span><span class="si">}</span><span class="s2">, phase maximized value: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">complex_val</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">normalized_val</span> <span class="o">=</span> <span class="n">inner_product</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">psd</span><span class="o">=</span><span class="s2">&quot;LISASens&quot;</span><span class="p">,</span> <span class="n">psd_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;sangria&quot;</span><span class="p">,</span> <span class="n">stochastic_params</span><span class="o">=</span><span class="p">(</span><span class="n">YRSID_SI</span><span class="p">,)),</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Normalized inner product &lt;h1|h2&gt;: </span><span class="si">{</span><span class="n">normalized_val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/mlkatz1/anaconda3/envs/lisa_env/lib/python3.12/site-packages/lisatools/detector.py:633: RuntimeWarning: divide by zero encountered in divide
  Sa_a = Sa_a_in * (1.0 + (0.4e-3 / frq) ** 2) * (1.0 + (frq / 8e-3) ** 4)
/Users/mlkatz1/anaconda3/envs/lisa_env/lib/python3.12/site-packages/lisatools/detector.py:635: RuntimeWarning: divide by zero encountered in power
  Sa_d = Sa_a * (2.0 * np.pi * frq) ** (-4.0)
/Users/mlkatz1/anaconda3/envs/lisa_env/lib/python3.12/site-packages/lisatools/detector.py:637: RuntimeWarning: invalid value encountered in multiply
  Sa_nu = Sa_d * (2.0 * np.pi * frq / C_SI) ** 2
/Users/mlkatz1/anaconda3/envs/lisa_env/lib/python3.12/site-packages/lisatools/detector.py:642: RuntimeWarning: divide by zero encountered in divide
  Soms_d = Soms_d_in * (1.0 + (2.0e-3 / f) ** 4)
/Users/mlkatz1/anaconda3/envs/lisa_env/lib/python3.12/site-packages/lisatools/detector.py:644: RuntimeWarning: invalid value encountered in multiply
  Soms_nu = Soms_d * (2.0 * np.pi * frq / C_SI) ** 2
/Users/mlkatz1/anaconda3/envs/lisa_env/lib/python3.12/site-packages/lisatools/stochastic.py:178: RuntimeWarning: divide by zero encountered in power
  * (f ** (-7.0 / 3.0))
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Inner product &lt;h1|h2&gt;: 1981.3392667268324
Complex inner product &lt;h1|h2&gt;: (1981.3392667268322+401.63841799838985j), phase maximized value: 2021.6376304090381
Normalized inner product &lt;h1|h2&gt;: 0.9800664328144687
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1e-05, np.float64(0.10206431774793984))
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_lisatools_tutorial_44_3.png" src="../_images/tutorial_lisatools_tutorial_44_3.png" />
</div>
</div>
</section>
<section id="SNR">
<h2>SNR<a class="headerlink" href="#SNR" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">opt_snr</span> <span class="o">=</span> <span class="n">snr</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">psd</span><span class="o">=</span><span class="s2">&quot;LISASens&quot;</span><span class="p">,</span> <span class="n">psd_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;sangria&quot;</span><span class="p">,</span> <span class="n">stochastic_params</span><span class="o">=</span><span class="p">(</span><span class="n">YRSID_SI</span><span class="p">,)))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal SNR &lt;h1|h1&gt;^(1/2): </span><span class="si">{</span><span class="n">opt_snr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">det_snr</span> <span class="o">=</span> <span class="n">snr</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">h2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">psd</span><span class="o">=</span><span class="s2">&quot;LISASens&quot;</span><span class="p">,</span> <span class="n">psd_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;sangria&quot;</span><span class="p">,</span> <span class="n">stochastic_params</span><span class="o">=</span><span class="p">(</span><span class="n">YRSID_SI</span><span class="p">,)))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Detected SNR against data h1 &lt;h1|h2&gt; / &lt;h1|h1&gt;^(1/2): </span><span class="si">{</span><span class="n">det_snr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Optimal SNR &lt;h1|h1&gt;^(1/2): 44.96261510900951
Detected SNR against data h1 &lt;h1|h2&gt; / &lt;h1|h1&gt;^(1/2): 44.06637073762678
</pre></div></div>
</div>
</section>
<section id="Perturbed-Waveform">
<h2>Perturbed Waveform<a class="headerlink" href="#Perturbed-Waveform" title="Link to this heading">ÔÉÅ</a></h2>
<p>Get a waveform with a small perturbation to a parameter.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set quantities for below calculations</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">f0</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">phi0</span><span class="p">])</span>
<span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-9</span>
<span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">parameter_transforms</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">/</span> <span class="mf">1e3</span>
<span class="p">}</span>

<span class="n">transform_fn</span> <span class="o">=</span> <span class="n">TransformContainer</span><span class="p">(</span><span class="n">parameter_transforms</span><span class="o">=</span><span class="n">parameter_transforms</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">f0</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">phi0</span><span class="p">])</span>
<span class="n">step</span> <span class="o">=</span> <span class="mf">1e-9</span>
<span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">parameter_transforms</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">/</span> <span class="mf">1e3</span>
<span class="p">}</span>

<span class="n">transform_fn</span> <span class="o">=</span> <span class="n">TransformContainer</span><span class="p">(</span><span class="n">parameter_transforms</span><span class="o">=</span><span class="n">parameter_transforms</span><span class="p">)</span>

<span class="c1"># will return 2D</span>
<span class="n">dh</span> <span class="o">=</span> <span class="n">h_var_p_eps</span><span class="p">(</span>
    <span class="n">step</span><span class="p">,</span>
    <span class="n">sine_waveform</span><span class="p">,</span>
    <span class="n">params</span><span class="p">,</span>
    <span class="n">index</span><span class="p">,</span>
    <span class="n">waveform_args</span><span class="o">=</span><span class="p">(</span><span class="n">t_arr</span><span class="p">,),</span>
    <span class="n">parameter_transforms</span><span class="o">=</span><span class="n">transform_fn</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_arr</span><span class="p">[:</span><span class="mi">250</span><span class="p">],</span> <span class="n">h1</span><span class="p">[:</span><span class="mi">250</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h1</span><span class="p">[:</span><span class="mi">250</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_arr</span><span class="p">[:</span><span class="mi">250</span><span class="p">],</span> <span class="n">dh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">250</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">250</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x148caf8f0&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_lisatools_tutorial_50_1.png" src="../_images/tutorial_lisatools_tutorial_50_1.png" />
</div>
</div>
</section>
<section id="Derivative-of-Waveform">
<h2>Derivative of Waveform<a class="headerlink" href="#Derivative-of-Waveform" title="Link to this heading">ÔÉÅ</a></h2>
<p>Compute the derivative of a waveform with respect to a parameter.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dhdlam</span> <span class="o">=</span> <span class="n">dh_dlambda</span><span class="p">(</span>
    <span class="n">eps</span><span class="p">,</span>
    <span class="n">sine_waveform</span><span class="p">,</span>
    <span class="n">params</span><span class="p">,</span>
    <span class="n">index</span><span class="p">,</span>
    <span class="n">waveform_args</span><span class="o">=</span><span class="p">(</span><span class="n">t_arr</span><span class="p">,),</span>
    <span class="n">parameter_transforms</span><span class="o">=</span><span class="n">transform_fn</span>
<span class="p">)</span>

<span class="c1"># TODO: check this?</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_arr</span><span class="p">[:</span><span class="mi">250</span><span class="p">],</span> <span class="n">h1</span><span class="p">[:</span><span class="mi">250</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h1</span><span class="p">[:</span><span class="mi">250</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_arr</span><span class="p">[:</span><span class="mi">250</span><span class="p">],</span> <span class="n">dhdlam</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">250</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dhdlam</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">250</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x148d8d040&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_lisatools_tutorial_53_1.png" src="../_images/tutorial_lisatools_tutorial_53_1.png" />
</div>
</div>
</section>
<section id="Information-Matrix-and-Covariance">
<h2>Information Matrix and Covariance<a class="headerlink" href="#Information-Matrix-and-Covariance" title="Link to this heading">ÔÉÅ</a></h2>
<p>Information matrix and covariance matrices.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">f0</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">phi0</span><span class="p">])</span>
<span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-9</span>

<span class="n">info_mat_args</span> <span class="o">=</span> <span class="p">(</span><span class="n">eps</span><span class="p">,</span> <span class="n">sine_waveform</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<span class="n">info_mat_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">deriv_inds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">inner_product_kwargs</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="s2">&quot;LISASens&quot;</span><span class="p">,</span>
        <span class="s2">&quot;psd_kwargs&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;sangria&quot;</span><span class="p">,</span> <span class="n">stochastic_params</span><span class="o">=</span><span class="p">(</span><span class="n">YRSID_SI</span><span class="p">,)),</span>
        <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="n">dt</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">return_derivs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">waveform_args</span><span class="o">=</span><span class="p">(</span><span class="n">t_arr</span><span class="p">,),</span>
    <span class="n">parameter_transforms</span><span class="o">=</span><span class="n">transform_fn</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">info_matrix</span><span class="p">(</span><span class="o">*</span><span class="n">info_mat_args</span><span class="p">,</span> <span class="o">**</span><span class="n">info_mat_kwargs</span><span class="p">)</span>

<span class="n">cov</span> <span class="o">=</span> <span class="n">covariance</span><span class="p">(</span>
    <span class="o">*</span><span class="n">info_mat_args</span><span class="p">,</span>
    <span class="n">info_mat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">diagonalize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">return_info_mat</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">precision</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">info_mat_kwargs</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 4.94652789e-04 -1.34367659e-13  1.19036834e-08]
 [-1.34367659e-13  1.46157988e-13 -1.45604730e-08]
 [ 1.19036834e-08 -1.45604730e-08  1.95551222e-03]]
</pre></div></div>
</div>
<p>Visualizing your information matrix.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">im</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\log_</span><span class="si">{10}</span><span class="s2">(M_</span><span class="si">{ij}</span><span class="s2">)$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.colorbar.Colorbar at 0x14fe7e480&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_lisatools_tutorial_58_1.png" src="../_images/tutorial_lisatools_tutorial_58_1.png" />
</div>
</div>
</section>
<section id="Plot-Covariance-in-Corner-Plot">
<h2>Plot Covariance in Corner Plot<a class="headerlink" href="#Plot-Covariance-in-Corner-Plot" title="Link to this heading">ÔÉÅ</a></h2>
<p>You can plot a corner plot by generated samples from the covariance matrix.s</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">plot_density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">plot_datapoints</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># fake in this case</span>
    <span class="n">smooth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># 1, 2, 3 sigma</span>
<span class="p">)</span>

<span class="n">plot_covariance_corner</span><span class="p">(</span>
    <span class="n">params</span><span class="p">,</span>
    <span class="n">cov</span><span class="p">,</span>
    <span class="o">**</span><span class="n">plot_kwargs</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_lisatools_tutorial_61_0.png" src="../_images/tutorial_lisatools_tutorial_61_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_lisatools_tutorial_61_1.png" src="../_images/tutorial_lisatools_tutorial_61_1.png" />
</div>
</div>
<p>Make a single contour plot.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plot_covariance_contour</span><span class="p">(</span>
    <span class="n">params</span><span class="p">,</span>
    <span class="n">cov</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="o">**</span><span class="n">plot_kwargs</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_lisatools_tutorial_63_1.png" src="../_images/tutorial_lisatools_tutorial_63_1.png" />
</div>
</div>
</section>
<section id="Get-Eigeninfo-of-a-matrix-(high-precision-capability)">
<h2>Get Eigeninfo of a matrix (high-precision capability)<a class="headerlink" href="#Get-Eigeninfo-of-a-matrix-(high-precision-capability)" title="Link to this heading">ÔÉÅ</a></h2>
<p>Get eigenvectors and eigenvalues of a matrix with high-precision capability.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span> <span class="o">=</span> <span class="n">get_eigeninfo</span><span class="p">(</span>
    <span class="n">cov</span><span class="p">,</span> <span class="n">high_precision</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([4.94652788e-04, 1.95551222e-03, 3.77427245e-14]),
 array([[ 1.00000000e+00,  8.14841119e-06,  9.24577470e-11],
        [-3.17858065e-11, -7.44586141e-06,  1.00000000e+00],
        [-8.14841119e-06,  1.00000000e+00,  7.44586140e-06]]))
</pre></div></div>
</div>
</section>
<section id="Scale-to-a-given-SNR">
<h2>Scale to a given SNR<a class="headerlink" href="#Scale-to-a-given-SNR" title="Link to this heading">ÔÉÅ</a></h2>
<p>Scaled an injection signal to a given SNR in place.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_snr</span> <span class="o">=</span> <span class="mf">30.0</span>

<span class="c1"># with 0.0 for the phase here, h1/h1_scaled will have a nan at the beginning.</span>
<span class="n">h1</span> <span class="o">=</span> <span class="n">sine_waveform</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">t_arr</span><span class="p">)</span>

<span class="n">h1_scaled</span> <span class="o">=</span> <span class="n">scale_to_snr</span><span class="p">(</span>
    <span class="n">target_snr</span><span class="p">,</span>
    <span class="n">h1</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
    <span class="n">psd</span><span class="o">=</span><span class="s2">&quot;LISASens&quot;</span><span class="p">,</span>
    <span class="n">psd_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;sangria&quot;</span><span class="p">,</span> <span class="n">stochastic_params</span><span class="o">=</span><span class="p">(</span><span class="n">YRSID_SI</span><span class="p">,))</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">h1</span> <span class="o">/</span> <span class="n">h1_scaled</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[1.49875455 1.49875455 1.49875455 ... 1.49875455 1.49875455 1.49875455]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/mlkatz1/anaconda3/envs/lisa_env/lib/python3.12/site-packages/lisatools/detector.py:633: RuntimeWarning: divide by zero encountered in divide
  Sa_a = Sa_a_in * (1.0 + (0.4e-3 / frq) ** 2) * (1.0 + (frq / 8e-3) ** 4)
/Users/mlkatz1/anaconda3/envs/lisa_env/lib/python3.12/site-packages/lisatools/detector.py:635: RuntimeWarning: divide by zero encountered in power
  Sa_d = Sa_a * (2.0 * np.pi * frq) ** (-4.0)
/Users/mlkatz1/anaconda3/envs/lisa_env/lib/python3.12/site-packages/lisatools/detector.py:637: RuntimeWarning: invalid value encountered in multiply
  Sa_nu = Sa_d * (2.0 * np.pi * frq / C_SI) ** 2
/Users/mlkatz1/anaconda3/envs/lisa_env/lib/python3.12/site-packages/lisatools/detector.py:642: RuntimeWarning: divide by zero encountered in divide
  Soms_d = Soms_d_in * (1.0 + (2.0e-3 / f) ** 4)
/Users/mlkatz1/anaconda3/envs/lisa_env/lib/python3.12/site-packages/lisatools/detector.py:644: RuntimeWarning: invalid value encountered in multiply
  Soms_nu = Soms_d * (2.0 * np.pi * frq / C_SI) ** 2
/Users/mlkatz1/anaconda3/envs/lisa_env/lib/python3.12/site-packages/lisatools/stochastic.py:178: RuntimeWarning: divide by zero encountered in power
  * (f ** (-7.0 / 3.0))
</pre></div></div>
</div>
</section>
<section id="Bias-estimate">
<h2>Bias estimate<a class="headerlink" href="#Bias-estimate" title="Link to this heading">ÔÉÅ</a></h2>
<p>Approximate waveform with a purposeful bias on the amplitude. Use the C-V bias estimate using our underlying covariance methods.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">sine_waveform_approx</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">phi0</span><span class="p">,</span> <span class="n">t_arr</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="mf">1.03</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">f0</span> <span class="o">*</span> <span class="mf">0.98</span><span class="p">)</span> <span class="o">*</span> <span class="n">t_arr</span> <span class="o">+</span> <span class="n">phi0</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys_err</span><span class="p">,</span> <span class="n">bias</span> <span class="o">=</span> <span class="n">cutler_vallisneri_bias</span><span class="p">(</span>
    <span class="n">sine_waveform</span><span class="p">,</span>
    <span class="n">sine_waveform_approx</span><span class="p">,</span>
    <span class="n">params</span><span class="p">,</span>
    <span class="n">eps</span><span class="p">,</span>
    <span class="n">parameter_transforms</span><span class="o">=</span><span class="n">transform_fn</span><span class="p">,</span>
    <span class="n">inner_product_kwargs</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="s2">&quot;LISASens&quot;</span><span class="p">,</span>
        <span class="s2">&quot;psd_kwargs&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;sangria&quot;</span><span class="p">,</span> <span class="n">stochastic_params</span><span class="o">=</span><span class="p">(</span><span class="n">YRSID_SI</span><span class="p">,)),</span>
        <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="n">dt</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">waveform_true_args</span><span class="o">=</span><span class="p">(</span><span class="n">t_arr</span><span class="p">,),</span>
    <span class="n">waveform_approx_args</span><span class="o">=</span><span class="p">(</span><span class="n">t_arr</span><span class="p">,),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sys_err</span><span class="p">,</span> <span class="n">bias</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[2.02172681e+03 1.59046154e+04 1.94227122e-01] [ 1.00005281e+00 -7.75106867e-10  1.72300784e-04]
</pre></div></div>
</div>
</section>
</section>
<section id="Data-/-Residual-/-Signal-Container">
<h1>Data / Residual / Signal Container<a class="headerlink" href="#Data-/-Residual-/-Signal-Container" title="Link to this heading">ÔÉÅ</a></h1>
<p>This container is a holder for data, residuals, or templates. These communicate with other classes like the Sensitivity Matrix to streamline different analyses.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">lisatools.datacontainer</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataResidualArray</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr1</span> <span class="o">=</span> <span class="n">sine_waveform</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">phi0</span><span class="p">,</span> <span class="n">t_arr</span><span class="p">)</span>
<span class="n">arr2</span> <span class="o">=</span> <span class="n">sine_waveform</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">phi0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">t_arr</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">DataResidualArray</span><span class="p">([</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">],</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">char_strain</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&lt;Figure size 640x480 with 2 Axes&gt;, array([&lt;Axes: &gt;, &lt;Axes: &gt;], dtype=object))
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_lisatools_tutorial_78_1.png" src="../_images/tutorial_lisatools_tutorial_78_1.png" />
</div>
</div>
</section>
<section id="Analysis-Container">
<h1>Analysis Container<a class="headerlink" href="#Analysis-Container" title="Link to this heading">ÔÉÅ</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">AnalysisContainer</span></code> brings together the <code class="docutils literal notranslate"><span class="pre">SensitivityMatrix</span></code> and the <code class="docutils literal notranslate"><span class="pre">DataResidualArray</span></code> to perform a variety of computations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">lisatools.analysiscontainer</span><span class="w"> </span><span class="kn">import</span> <span class="n">AnalysisContainer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lisatools.sensitivity</span><span class="w"> </span><span class="kn">import</span> <span class="n">LISASens</span>

<span class="n">sens_mat</span> <span class="o">=</span> <span class="n">SensitivityMatrix</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">f_arr</span><span class="p">,</span> <span class="p">[</span><span class="n">LISASens</span><span class="p">,</span> <span class="n">LISASens</span><span class="p">],</span> <span class="n">stochastic_params</span><span class="o">=</span><span class="p">(</span><span class="n">YRSID_SI</span><span class="p">,))</span>
<span class="n">analysis</span> <span class="o">=</span> <span class="n">AnalysisContainer</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sens_mat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span><span class="o">.</span><span class="n">loglog</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/mlkatz1/anaconda3/envs/lisa_env/lib/python3.12/site-packages/lisatools/sensitivity.py:747: RuntimeWarning: invalid value encountered in multiply
  plot_in = np.sqrt(self.frequency_arr * plot_in)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&lt;Figure size 640x480 with 2 Axes&gt;, array([&lt;Axes: &gt;, &lt;Axes: &gt;], dtype=object))
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_lisatools_tutorial_82_2.png" src="../_images/tutorial_lisatools_tutorial_82_2.png" />
</div>
</div>
<section id="Direct-computations-on-the-residual-contained-in-the-DataResidualArrray.">
<h2>Direct computations on the residual contained in the <code class="docutils literal notranslate"><span class="pre">DataResidualArrray</span></code>.<a class="headerlink" href="#Direct-computations-on-the-residual-contained-in-the-DataResidualArrray." title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span><span class="o">.</span><span class="n">inner_product</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1646.1603122108786
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span><span class="o">.</span><span class="n">likelihood</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
np.float64(-inf)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span><span class="o">.</span><span class="n">likelihood</span><span class="p">(</span><span class="n">source_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-823.0801561054393
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span><span class="o">.</span><span class="n">likelihood</span><span class="p">(</span><span class="n">noise_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
np.float64(-inf)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span><span class="o">.</span><span class="n">snr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
40.57290120524879
</pre></div></div>
</div>
</section>
<section id="Build-a-template-and-then-compare-it-to-the-data.">
<h2>Build a template and then compare it to the data.<a class="headerlink" href="#Build-a-template-and-then-compare-it-to-the-data." title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># build template</span>
<span class="n">h_test</span> <span class="o">=</span> <span class="n">DataResidualArray</span><span class="p">([</span>
    <span class="n">sine_waveform</span><span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">phi0</span> <span class="o">+</span> <span class="mf">0.002</span><span class="p">,</span> <span class="n">t_arr</span><span class="p">),</span>
    <span class="n">sine_waveform</span><span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">phi0</span> <span class="o">+</span> <span class="mf">0.002</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">t_arr</span><span class="p">)</span>
<span class="p">]</span> <span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Template Inner product: </span><span class="si">{</span><span class="n">analysis</span><span class="o">.</span><span class="n">template_inner_product</span><span class="p">(</span><span class="n">h_test</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># , analysis.template_likelihood, analysis.template_snr</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Template SNR: </span><span class="si">{</span><span class="n">analysis</span><span class="o">.</span><span class="n">template_snr</span><span class="p">(</span><span class="n">h_test</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># , analysis.template_likelihood, analysis.template_snr</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Template Likelihood: </span><span class="si">{</span><span class="n">analysis</span><span class="o">.</span><span class="n">template_likelihood</span><span class="p">(</span><span class="n">h_test</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># , analysis.template_likelihood, analysis.template_snr</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Template Inner product: 1728.4648708859095
Template SNR: (np.float64(42.60154626551122), np.float64(40.572820059473216))
Template Likelihood: -2.0611573257758664
</pre></div></div>
</div>
</section>
<section id="Build-a-template-generation-model-and-add-to-the-AnalysisContainer">
<h2>Build a template generation model and add to the <code class="docutils literal notranslate"><span class="pre">AnalysisContainer</span></code><a class="headerlink" href="#Build-a-template-generation-model-and-add-to-the-AnalysisContainer" title="Link to this heading">ÔÉÅ</a></h2>
<p>This allows for inputing parameters and waveform settings directly to the <code class="docutils literal notranslate"><span class="pre">AnalysisContainer</span></code> for computations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">signal_model_sine</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">phi0</span><span class="p">,</span> <span class="n">t_arr</span><span class="p">):</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">DataResidualArray</span><span class="p">([</span>
        <span class="n">sine_waveform</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">phi0</span><span class="p">,</span> <span class="n">t_arr</span><span class="p">),</span>
        <span class="n">sine_waveform</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">phi0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">t_arr</span><span class="p">)</span>
    <span class="p">]</span> <span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">template</span>

<span class="n">analysis</span><span class="o">.</span><span class="n">signal_gen</span> <span class="o">=</span> <span class="n">signal_model_sine</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;With parameters likelihood: </span><span class="si">{</span><span class="n">analysis</span><span class="o">.</span><span class="n">calculate_signal_likelihood</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">f0</span><span class="p">,</span><span class="w"> </span><span class="n">phi0</span><span class="p">,</span><span class="w"> </span><span class="n">t_arr</span><span class="p">,</span><span class="w"> </span><span class="n">source_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;With parameters snr: </span><span class="si">{</span><span class="n">analysis</span><span class="o">.</span><span class="n">calculate_signal_snr</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">f0</span><span class="p">,</span><span class="w"> </span><span class="n">phi0</span><span class="p">,</span><span class="w"> </span><span class="n">t_arr</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;With parameters inner product: </span><span class="si">{</span><span class="n">analysis</span><span class="o">.</span><span class="n">calculate_signal_inner_product</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">f0</span><span class="p">,</span><span class="w"> </span><span class="n">phi0</span><span class="p">,</span><span class="w"> </span><span class="n">t_arr</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Adjust amplitude:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;With parameters likelihood: </span><span class="si">{</span><span class="n">analysis</span><span class="o">.</span><span class="n">calculate_signal_likelihood</span><span class="p">(</span><span class="n">A</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.03</span><span class="p">,</span><span class="w"> </span><span class="n">f0</span><span class="p">,</span><span class="w"> </span><span class="n">phi0</span><span class="p">,</span><span class="w"> </span><span class="n">t_arr</span><span class="p">,</span><span class="w"> </span><span class="n">source_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;With parameters snr: </span><span class="si">{</span><span class="n">analysis</span><span class="o">.</span><span class="n">calculate_signal_snr</span><span class="p">(</span><span class="n">A</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.03</span><span class="p">,</span><span class="w"> </span><span class="n">f0</span><span class="p">,</span><span class="w"> </span><span class="n">phi0</span><span class="p">,</span><span class="w"> </span><span class="n">t_arr</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;With parameters inner product: </span><span class="si">{</span><span class="n">analysis</span><span class="o">.</span><span class="n">calculate_signal_inner_product</span><span class="p">(</span><span class="n">A</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.03</span><span class="p">,</span><span class="w"> </span><span class="n">f0</span><span class="p">,</span><span class="w"> </span><span class="n">phi0</span><span class="p">,</span><span class="w"> </span><span class="n">t_arr</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
With parameters likelihood: -0.0
With parameters snr: (np.float64(40.57290120524879), np.float64(40.57290120524879))
With parameters inner product: 1646.1603122108786
Adjust amplitude:
With parameters likelihood: -0.7407721404947551
With parameters snr: (np.float64(41.79008824140625), np.float64(40.57290120524879))
With parameters inner product: 1695.545121577205
</pre></div></div>
</div>
</section>
</section>
<section id="Comparing-XYZ-and-AET">
<h1>Comparing XYZ and AET<a class="headerlink" href="#Comparing-XYZ-and-AET" title="Link to this heading">ÔÉÅ</a></h1>
<p>The XYZ TDI channels have correlated noise. In matrix form, you can imagine this as</p>
<div class="math notranslate nohighlight">
\[\begin{split}C = \left(\begin{matrix}
    XX &amp; XY &amp; XZ \\
    YX &amp; YY &amp; YZ \\
    ZX &amp; ZY &amp; ZZ
\end{matrix}\right).\end{split}\]</div>
<p>.</p>
<p>For AET, this becomes diagonalized:</p>
<div class="math notranslate nohighlight">
\[\begin{split}C' = \left(\begin{matrix}
    AA &amp; 0 &amp; 0 \\
    0 &amp; EE &amp; 0 \\
    0 &amp; 0 &amp; TT
\end{matrix}\right).\end{split}\]</div>
<p>In the inner product equation, the multiplication of the template and noise is given as <span class="math notranslate nohighlight">\((\mathbf{h}^T \mathbf{C}^{-1} \mathbf{h})\)</span>. In the XYZ basis, the full 3x3 matrix at each frequency must be inverted. In the AET basis, the inversion is equivalent to taking 1 over the sensitivity value themselves.</p>
<p>A good check is to verify that your inner product values are equivalent in both bases. To do this, you need real TDI templates. So, we will use <code class="docutils literal notranslate"><span class="pre">GBGPU</span></code> to put in one Galactic binary waveform.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># setup a data stream</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">Tobs</span> <span class="o">=</span> <span class="n">YRSID_SI</span> <span class="o">/</span> <span class="mf">2.0</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Tobs</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">Tobs</span> <span class="o">=</span> <span class="n">N</span> <span class="o">*</span> <span class="n">dt</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>

<span class="n">data_xyz</span> <span class="o">=</span> <span class="n">DataResidualArray</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">data_aet</span> <span class="o">=</span> <span class="n">DataResidualArray</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># build waveforms</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gbgpu.gbgpu</span><span class="w"> </span><span class="kn">import</span> <span class="n">GBGPU</span>
<span class="n">gb</span> <span class="o">=</span> <span class="n">GBGPU</span><span class="p">()</span>
<span class="n">gb</span><span class="o">.</span><span class="n">run_wave</span><span class="p">(</span>
    <span class="mf">1e-23</span><span class="p">,</span> <span class="mf">0.003</span><span class="p">,</span> <span class="mf">1e-17</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">Tobs</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">oversample</span><span class="o">=</span><span class="mi">4</span>
<span class="p">)</span>

<span class="c1"># inject waveforms</span>
<span class="n">data_xyz</span><span class="p">[:,</span> <span class="n">gb</span><span class="o">.</span><span class="n">start_inds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">gb</span><span class="o">.</span><span class="n">start_inds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">gb</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">gb</span><span class="o">.</span><span class="n">XYZf</span><span class="p">[:]</span>
<span class="p">)</span>
<span class="n">data_aet</span><span class="p">[:,</span> <span class="n">gb</span><span class="o">.</span><span class="n">start_inds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">gb</span><span class="o">.</span><span class="n">start_inds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">gb</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">AET</span><span class="p">(</span><span class="o">*</span><span class="n">gb</span><span class="o">.</span><span class="n">XYZf</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="p">)</span>

<span class="c1"># set sensitivity matrices</span>
<span class="n">sens_xyz</span> <span class="o">=</span> <span class="n">XYZ1SensitivityMatrix</span><span class="p">(</span><span class="n">data_xyz</span><span class="o">.</span><span class="n">f_arr</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;scirdv1&quot;</span><span class="p">)</span>
<span class="n">sens_aet</span> <span class="o">=</span> <span class="n">AET1SensitivityMatrix</span><span class="p">(</span><span class="n">data_aet</span><span class="o">.</span><span class="n">f_arr</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;scirdv1&quot;</span><span class="p">)</span>

<span class="n">ac_xyz</span> <span class="o">=</span> <span class="n">AnalysisContainer</span><span class="p">(</span><span class="n">data_xyz</span><span class="p">,</span> <span class="n">sens_xyz</span><span class="p">)</span>
<span class="n">ac_aet</span> <span class="o">=</span> <span class="n">AnalysisContainer</span><span class="p">(</span><span class="n">data_aet</span><span class="p">,</span> <span class="n">sens_aet</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">ac_xyz</span><span class="o">.</span><span class="n">inner_product</span><span class="p">(),</span> <span class="n">ac_aet</span><span class="o">.</span><span class="n">inner_product</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ac_xyz</span><span class="o">.</span><span class="n">likelihood</span><span class="p">(</span><span class="n">source_only</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">ac_aet</span><span class="o">.</span><span class="n">likelihood</span><span class="p">(</span><span class="n">source_only</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="c1"># TODO: currently a small difference in noise-included likelihoodm</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ac_xyz</span><span class="o">.</span><span class="n">likelihood</span><span class="p">(),</span> <span class="n">ac_aet</span><span class="o">.</span><span class="n">likelihood</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
19.134165338394837 19.134165338394727
-9.567082669197418 -9.567082669197363
108203542.2031658 108203940.3557624
</pre></div></div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../user/sources.html" class="btn btn-neutral float-left" title="GW Source Tools" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Michael L. Katz 2024.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>